<!DOCTYPE html>
<html>
<head>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <meta charset="UTF-8">
    <title>ATHEMIANARTORY WEB CHAT</title>
    <style>
#notification-panel {
    position: absolute;
    top: 60px; 
    right: 10px; /* Ch·ªânh l·∫°i right ƒë·ªÉ hi·ªán b√™n ph·∫£i sidebar */
    width: 260px;
    background: #111; 
    border: 1px solid #333;
    border-radius: 12px; 
    display: none; 
    z-index: 1000;
    box-shadow: 0 10px 30px rgba(0,0,0,0.8);
    text-align: left; /* ƒê·∫£m b·∫£o ch·ªØ canh l·ªÅ tr√°i */
}
.noti-header {
    padding: 12px; border-bottom: 1px solid #222;
    display: flex; justify-content: space-between;
    font-size: 14px; color: #fff; font-weight: bold;
}
.noti-list { max-height: 300px; overflow-y: auto; }
.noti-item {
    padding: 12px; border-bottom: 1px solid #1a1a1a;
    font-size: 13px; color: #ccc; cursor: default;
}
.noti-item:hover { background: #1a1a1a; }
.noti-item b { color: #0084ff; }
/* Ch·∫•m ƒë·ªè th√¥ng b√°o */
/* T√¨m v√† thay th·∫ø ƒëo·∫°n .badge c≈© b·∫±ng ƒëo·∫°n n√†y */
.badge {
    background: #ff0000;
    color: white;
    border-radius: 50%;
    /* Ch·ªânh padding ƒë·ªÉ s·ªë n·∫±m gi·ªØa v√≤ng tr√≤n */
    padding: 2px 5px; 
    font-size: 10px;
    font-weight: bold;
    position: absolute;
    /* V·ªã tr√≠ chu·∫©n ƒë·ªÉ ƒë√® l√™n g√≥c ph·∫£i c√°i chu√¥ng */
    top: -2px; 
    right: -5px; 
    display: none;
    border: 2px solid #000; /* Vi·ªÅn ƒëen ƒë·ªÉ nh√¨n r√µ tr√™n n·ªÅn t·ªëi */
    pointer-events: none; /* ƒê·ªÉ kh√¥ng b·ªã b·∫•m nh·∫ßm v√†o s·ªë */
}
/* Giao di·ªán b·∫£ng th√¥ng b√°o */
#notification-panel {
    position: absolute;
    top: 60px; left: 10px; width: 280px;
    background: #111; border: 1px solid #333;
    border-radius: 12px; display: none; z-index: 1000;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}


.noti-header {
    padding: 12px; border-bottom: 1px solid #222;
    display: flex; justify-content: space-between;
    font-size: 14px; color: #fff; font-weight: bold;
}


.noti-list { max-height: 300px; overflow-y: auto; }
.noti-item {
    padding: 12px; border-bottom: 1px solid #1a1a1a;
    font-size: 13px; color: #ccc; cursor: default;
}


.noti-item:hover { background: #1a1a1a; }
.noti-item b { color: #0084ff; }



        /* CSS cho B·∫£ng gi·ªõi thi·ªáu */
#intro-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.9); /* L√†m t·ªëi n·ªÅn ph√≠a sau */
    z-index: 10000; /* N·∫±m tr√™n c·∫£ ph·∫ßn ƒëƒÉng nh·∫≠p */
    display: flex; align-items: center; justify-content: center;
    backdrop-filter: blur(8px); /* L√†m m·ªù ·∫£nh n·ªÅn */
}
.delete-friend-btn:hover {
    background: rgba(255, 77, 77, 0.1);
    border-radius: 50%;
    transform: scale(1.2);
    transition: 0.2s;
}


.intro-box {
    background: #111; border: 1px solid #0084ff; border-radius: 25px;
    width: 400px; padding: 30px; text-align: center; color: white;
    box-shadow: 0 0 30px rgba(0, 132, 255, 0.3);
    animation: fadeInScale 0.5s ease-out;
}
.intro-header h2 { color: #0084ff; margin: 15px 0; }
.intro-content { text-align: left; margin: 20px 0; line-height: 1.6; }
.intro-content ul { padding-left: 20px; }
.intro-content li { margin-bottom: 8px; }
#close-intro-btn {
    width: 100%; padding: 15px; border-radius: 15px; border: none;
    background: linear-gradient(45deg, #0084ff, #00c6ff);
    color: white; font-weight: bold; cursor: pointer; font-size: 16px;
    transition: 0.3s;
}
#close-intro-btn:hover { transform: scale(1.02); box-shadow: 0 5px 15px rgba(0, 132, 255, 0.4); }
#intro-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: url('nen.jpg.jpg') no-repeat center center/cover;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Hi·ªáu ·ª©ng l·ªõp ph·ªß t·ªëi ƒë·ªÉ n·ªïi b·∫≠t b·∫£ng */
#intro-overlay::before {
    content: "";
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(15px); /* L√†m m·ªù n·ªÅn c·ª±c m·∫°nh cho chuy√™n nghi·ªáp */
}

.intro-card {
    position: relative;
    display: flex;
    width: 80%;
    max-width: 900px;
    height: 500px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 30px;
    overflow: hidden;
    box-shadow: 0 25px 50px rgba(0,0,0,0.5);
}

/* Ph·∫ßn h√¨nh ·∫£nh b√™n tr√°i */
.intro-visual {
    flex: 1;
    background: linear-gradient(135deg, #0084ff, #00c6ff);
    display: flex;
    align-items: center;
    justify-content: center;
}
.intro-visual img {
    width: 60%;
    filter: drop-shadow(0 10px 20px rgba(0,0,0,0.2));
    animation: float 3s ease-in-out infinite;
}

/* Ph·∫ßn n·ªôi dung b√™n ph·∫£i */
.intro-text {
    flex: 1.2;
    padding: 40px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    color: white;
}

.intro-text h1 {
    font-size: 32px;
    margin: 0;
    letter-spacing: 2px;
    background: linear-gradient(to right, #fff, #0084ff);
    -webkit-text-fill-color: transparent;
}

.subtitle { color: #888; margin-bottom: 30px; font-style: italic; }

.feature-grid {
    display: grid;
    gap: 20px;
    margin-bottom: 30px;
}

.feature-item {
    display: flex;
    gap: 15px;
    align-items: flex-start;
}

.feature-item span { font-size: 24px; }
.feature-item h3 { margin: 0; font-size: 16px; color: #0084ff; }
.feature-item p { margin: 0; font-size: 13px; color: #ccc; }

#close-intro-btn {
    padding: 15px;
    border: none;
    border-radius: 50px;
    background: white;
    color: black;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
    text-transform: uppercase;
}

#close-intro-btn:hover {
    background: #0084ff;
    color: white;
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(0, 132, 255, 0.3);
}
#intro-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: #000; /* N·ªÅn ƒëen ho√†n to√†n ƒë·ªÉ sang tr·ªçng */
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
}

.intro-card-pro {
    position: relative;
    width: 450px; /* ƒê·ªô r·ªông v·ª´a ph·∫£i ki·ªÉu Poster */
    background: #111; /* N·ªÅn x√°m ƒëen c·ª±c s√¢u */
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 40px 100px rgba(0,0,0,0.8);
    border: 1px solid rgba(255, 255, 255, 0.05);
}

/* Khu v·ª±c ·∫£nh ph√≠a tr√™n */
.intro-image-area {
    position: relative;
    width: 100%;
    height: 240px;
    overflow: hidden;
}

.intro-image-area img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 10s ease;
}

.intro-card-pro:hover .intro-image-area img {
    transform: scale(1.1); /* Hi·ªáu ·ª©ng zoom ·∫£nh ch·∫≠m r√£i chuy√™n nghi·ªáp */
}

.image-overlay-gradient {
    position: absolute;
    bottom: 0; left: 0; width: 100%; height: 50%;
    background: linear-gradient(to top, #111, transparent);
}

/* Khu v·ª±c n·ªôi dung ph√≠a d∆∞·ªõi */
.intro-body-pro {
    padding: 40px;
    text-align: center;
    color: #fff;
}

.brand-name {
    font-size: 12px;
    letter-spacing: 4px;
    color: #0084ff;
    font-weight: 700;
    margin-bottom: 15px;
    text-transform: uppercase;
}

.intro-title {
    font-size: 22px;
    font-weight: 600;
    line-height: 1.4;
    margin-bottom: 20px;
}

.intro-description {
    font-size: 14px;
    color: #aaa;
    line-height: 1.6;
    margin-bottom: 30px;
    font-weight: 300;
}

.divider {
    width: 40px;
    height: 2px;
    background: #0084ff;
    margin: 0 auto 30px;
}

#close-intro-btn {
    width: 100%;
    padding: 16px;
    border: 1px solid #333;
    border-radius: 6px;
    background: transparent;
    color: #fff;
    font-size: 13px;
    font-weight: 600;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.3s ease;
}

#close-intro-btn:hover {
    background: #fff;
    color: #000;
    border-color: #fff;
}
#intro-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    /* THAY LINK ·∫¢NH C√îNG TY C·ª¶A B·∫†N V√ÄO ƒê√ÇY */
    background: url('link-anh-cong-ty-cua-ban.jpg') no-repeat center center;
    background-size: cover; /* Quan tr·ªçng: Gi√∫p ·∫£nh tr√†n to√†n m√†n h√¨nh */
    z-index: 10000;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-family: 'Segoe UI', sans-serif;
}

/* L·ªõp ph·ªß t·ªëi ƒë·ªÉ ch·ªØ n·ªïi b·∫≠t tr√™n ·∫£nh */
#intro-overlay::before {
    content: "";
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.5); /* ƒê·ªô ƒë·∫≠m nh·∫°t c·ªßa l·ªõp ph·ªß (0.5 l√† 50%) */
    z-index: 1;
}

.intro-content-full {
    position: relative;
    z-index: 2;
    text-align: center;
    color: white;
    max-width: 800px;
    padding: 20px;
}

.brand-badge {
    font-size: 14px;
    letter-spacing: 6px;
    text-transform: uppercase;
    color: #0084ff;
    margin-bottom: 20px;
    font-weight: bold;
}

.main-title {
    font-size: clamp(32px, 5vw, 56px); /* T·ª± ƒë·ªông co gi√£n c·ª° ch·ªØ */
    font-weight: 700;
    line-height: 1.2;
    margin-bottom: 24px;
    text-shadow: 0 4px 15px rgba(0,0,0,0.5);
}

.main-lead {
    font-size: 18px;
    color: rgba(255, 255, 255, 0.8);
    line-height: 1.6;
    margin-bottom: 40px;
    font-weight: 300;
}

#close-intro-btn {
    padding: 18px 48px;
    font-size: 14px;
    font-weight: 600;
    letter-spacing: 2px;
    color: white;
    background: transparent;
    border: 2px solid white;
    cursor: pointer;
    transition: all 0.4s ease;
}

#close-intro-btn:hover {
    background: white;
    color: black;
}

.intro-footer {
    position: absolute;
    bottom: 50px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 2;
    font-size: 12px;
    color: rgba(255, 255, 255, 0.4);
    letter-spacing: 2px;
    text-transform: uppercase;
}
.footer-note {
    margin-top: 25px;
    font-size: 10px;
    color: #444;
    text-transform: uppercase;
    letter-spacing: 1px;
}
/* Hi·ªáu ·ª©ng bay b·ªïng */
@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-20px); }
}
/* Hi·ªáu ·ª©ng hi·ªán ra */
@keyframes fadeInScale {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
}
        /* GI·ªÆ NGUY√äN GIAO DI·ªÜN G·ªêC */
        body { 
            font-family: 'Segoe UI', Tahoma, sans-serif; 
            background: #000; 
            background-image: url('nen.jpg.jpg');
            background-size: cover; background-position: center;
            margin: 0; padding: 0; height: 100vh; overflow: hidden; 
        }
        .main-wrapper { display: flex; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.8); }
        
        /* SIDEBAR */
        .sidebar { width: 300px; background: #000; border-right: 1px solid #222; display: flex; flex-direction: column; }
        .sidebar-header { padding: 20px; font-size: 20px; font-weight: bold; color: white; border-bottom: 1px solid #111; }
        .room-controls { padding: 15px; border-bottom: 1px solid #111; }
        .room-controls input {
            width: 100%; padding: 12px; border-radius: 10px; border: none; box-sizing: border-box;
            background: #1a1a1a; color: white; margin-bottom: 10px; outline: none;
        }
        .btn-group { display: flex; gap: 5px; }
        .btn-group button { flex: 1; padding: 10px; border-radius: 15px; border: none; font-weight: bold; cursor: pointer; color: white; font-size: 11px; }
        #create-btn { background: #1a1a1a; border: 1px solid #333; }
        #join-btn { background: #0084ff; }
        .current-room-tag { background: #0a0a0a; border-radius: 8px; padding: 10px; margin: 10px 15px; color: #ff4d94; font-weight: bold; font-size: 13px; text-align: center; border: 1px solid #222; }

        /* PH·∫¶N B·∫†N B√à M·ªöI */
        .friend-section { flex: 1; overflow-y: auto; padding: 15px; }
        .friend-section h4 { color: #555; font-size: 12px; text-transform: uppercase; margin-bottom: 10px; }
        .friend-item { padding: 10px; border-radius: 10px; color: white; cursor: pointer; display: flex; align-items: center; gap: 10px; transition: 0.2s; }
        .friend-item:hover { background: #1a1a1a; }
        .friend-item.active { background: #0084ff; }
        .add-friend-box { padding: 15px; border-top: 1px solid #111; }

        /* CHAT BOX AREA */
        .chat-container { flex: 1; display: flex; flex-direction: column; }
        #chat-box { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }

        /* THANH C√îNG C·ª§ D∆Ø·ªöI C√ôNG */
        .bottom-toolbar {
            background: #000;
            padding: 15px 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-top: 1px solid #111;
        }
        #username { 
            width: 120px; padding: 10px; border-radius: 15px; 
            border: none; background: #1a1a1a; color: #0084ff; 
            font-weight: bold; text-align: center; outline: none;
        }
        .input-wrapper { 
            flex: 1; background: #1a1a1a; border-radius: 25px; 
            display: flex; align-items: center; padding: 5px 20px;
        }
        #msg-input { 
            flex: 1; background: transparent; border: none; 
            color: white; padding: 10px 0; outline: none; font-size: 14px;
        }
        .icon-btn { 
            background: #333; color: white; border: none; 
            width: 45px; height: 40px; border-radius: 20px; 
            cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px;
        }
        #send-btn { 
            background: #0084ff; color: white; border: none; 
            padding: 10px 25px; border-radius: 20px; font-weight: bold; cursor: pointer;
        }

        /* OVERLAY ƒêƒÇNG NH·∫¨P */
        /* GIAO DI·ªÜN ƒêƒÇNG NH·∫¨P CYBERPUNK */
/* GIAO DI·ªÜN ƒêƒÇNG NH·∫¨P MAP CYBERPUNK */
/* GIAO DI·ªÜN ƒêƒÇNG NH·∫¨P MAP CYBERPUNK */
#auth-overlay {
    position: fixed; 
    top: 0; left: 0; 
    width: 100vw; 
    height: 100vh;
    /* QUAN TR·ªåNG: ƒê·∫£m b·∫£o t√™n file ·∫£nh d∆∞·ªõi ƒë√¢y tr√πng kh·ªõp v·ªõi file ·∫£nh b·∫£n ƒë·ªì c·ªßa b·∫°n */
    background: #000 url('image_29a4f0.jpg') no-repeat center center;
    background-size: cover; 
    z-index: 9999; 
    display: flex; 
    align-items: center; 
    justify-content: center;
    font-family: 'Courier New', Courier, monospace;
}

/* Th√™m hi·ªáu ·ª©ng radar qu√©t ƒë·ªÉ l√†m n·ªïi b·∫≠t t√≠nh Cyberpunk */
#auth-overlay::after {
    content: "";
    position: absolute; top: 0; left: 0; width: 100%; height: 2px;
    background: rgba(0, 255, 0, 0.5);
    box-shadow: 0 0 15px #00ff00;
    animation: scanline 4s linear infinite;
    z-index: 10000; pointer-events: none;
}

@keyframes scanline {
    0% { top: 0; }
    100% { top: 100%; }
}

.auth-box { 
    background: rgba(0, 10, 0, 0.9); 
    padding: 35px; 
    border-radius: 2px; 
    width: 380px; 
    text-align: center; 
    border: 1px solid #00ff00; 
    box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
    position: relative;
    z-index: 10001;
    backdrop-filter: blur(4px);
}

.auth-box h2 { 
    color: #00ff00; 
    font-size: 20px;
    margin-bottom: 25px; 
    letter-spacing: 4px;
    text-shadow: 0 0 8px #00ff00;
}

.auth-box input { 
    width: 100%; 
    padding: 12px; 
    margin-bottom: 15px; 
    border: 1px solid #004400; 
    background: rgba(0, 30, 0, 0.5); 
    color: #00ff00; 
    box-sizing: border-box; 
    outline: none;
    font-size: 13px;
}

.auth-box input::placeholder { color: #004400; }

.auth-box button { 
    width: 100%; 
    padding: 14px; 
    border: 1px solid #00ff00; 
    background: #00ff00; 
    color: #000; 
    font-weight: bold; 
    cursor: pointer; 
    text-transform: uppercase;
    transition: 0.3s;
}

.auth-box button:hover { 
    background: #000; 
    color: #00ff00; 
    box-shadow: 0 0 15px #00ff00;
}

.terminal-text {
    font-size: 10px;
    color: #00ff00;
    text-align: left;
    margin-top: 15px;
    opacity: 0.7;
}
        .auth-box { background: #111; padding: 30px; border-radius: 20px; width: 300px; text-align: center; border: 1px solid #222; }
        .auth-box h2 { color: white; margin-bottom: 20px; }
        .auth-box input { width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 10px; border: none; background: #222; color: white; box-sizing: border-box; }
        .auth-box button { width: 100%; padding: 12px; border-radius: 10px; border: none; background: #0084ff; color: white; font-weight: bold; cursor: pointer; }

        /* TIN NH·∫ÆN */
        .msg-wrapper { display: flex; flex-direction: column; max-width: 70%; margin-bottom: 5px; }
        .my-msg { align-self: flex-end; }
        .my-msg .msg-text { background: #0084ff; color: white; border-radius: 15px 15px 0 15px; padding: 10px 15px; }
        .other-msg { align-self: flex-start; }
        .other-msg .msg-text { background: #1a1a1a; color: white; border-radius: 15px 15px 15px 0; padding: 10px 15px; }
        .msg-name { font-size: 11px; color: #666; margin-bottom: 3px; }

        #context-menu { position: fixed; z-index: 999; width: 150px; background: #111; border: 1px solid #333; border-radius: 10px; display: none; }
        #context-menu div { padding: 12px; color: #ff4d4d; cursor: pointer; font-weight: bold; font-size: 13px; }
        #emoji-picker { position: absolute; bottom: 80px; right: 100px; background: #111; border: 1px solid #333; border-radius: 15px; padding: 10px; display: none; grid-template-columns: repeat(5, 1fr); gap: 5px; }
        .emoji-item { cursor: pointer; font-size: 20px; padding: 5px; }
    </style>
</head>
<body>
    <audio id="noti-sound" src="https://www.soundjay.com/buttons/sounds/button-3.mp3" preload="auto"></audio>
    <div id="intro-overlay">
    <div class="intro-content-full">
        <div class="brand-badge">Astronomy-History-Geography-Webchat-Community</div>
        <h1 class="main-title">ATHEMIANARTORY INTERNATIONAL</h1>
        <p class="main-lead">
            L·ªúI M·ªû ƒê·∫¶U<br>
            Xin ch√†o, t√¥i l√† Death-Athemianar, ƒë·ªìng s√°ng l·∫≠p c·ªßa ATHEMIANARTORY CHAT, t√¥i ·ªü ƒë√¢y, v√¨ 1 l√Ω do ng·ªõ ng·∫©n n√†o ƒë√≥ l·∫°i l√†m ra ·ª©ng d·ª•ng n√†y.
            T·ª´ nƒÉm 2026 th√¨ zalo ƒë√£ c√≥ quy·∫øt d·ªãnh kh√° l√† ƒë√°ng ti·∫øc l√† quy·∫øt ƒë·ªãnh th√¥ng t∆∞, v√¨ v·∫≠y...ƒë∆°n gi·∫£n th√¥i..c√≥ web n√†y ra ƒë·ªùi ƒë·ªÉ ph·ª•c v·ª• cho 
            m·ªçi ng∆∞·ªùi m√† c√≥ th·ªÉ n√≥i chuy·ªán m√† kh√¥ng b·ªã ho·∫∑c d√≤m ng√≥ b·ªüi c√°c b√™n th·ª© ba, ƒë√≥ l√† l√Ω do ch√≠nh t√¥i l√†m ra ·ª©ng d·ª•ng n√†y. g·ª≠i l·ªùi ch√†o c≈©ng nh∆∞ l·ªùi c·∫£m ∆°n v√¨ da den ƒë√¢y, n√≥i chung l√†... enjoy!<br>
            <br>
            <br> K√Ω t√™n: Death-Athemianar (S√≥i L·ªãch S·ª≠) <br>
            t·ªïng ch·ªâ huy-ƒë·ªìng s√°ng l·∫≠p ATHEMIANARTORY INTERNATIONAL v·ªõi Kenter v√† ƒêLMD.<br>


        </p>
        
        <div class="action-area">
            <button id="close-intro-btn">B·∫ÆT ƒê·∫¶U TR·∫¢I NGHI·ªÜM (B·∫£n Demo)</button>
        </div>

        <div class="intro-footer">
            <span>Security</span> ‚Ä¢ <span>Privacy</span> ‚Ä¢ <span>Performance</span>
        </div>
    </div>
</div>
    <div id="auth-overlay">
    <div class="auth-box">
        <div style="font-size: 9px; color: #00ff00; text-align: left; margin-bottom: 5px;">[ SYSTEM ACCESS PROTOCOL ]</div>
        <h2>ƒêƒÇNG NH·∫¨P</h2>
        
        <input type="text" id="auth-user" placeholder="INPUT_ID_">
        <input type="password" id="auth-pass" placeholder="INPUT_PASSCODE_">
        
        <button id="auth-btn">B·∫Øt ƒê·∫ßu</button>
        
        <div class="terminal-text">
            > Connection: Encrypted<br>
            > Proxy: Enabled<br>
            > Status: Waiting for Credentials...
        </div>
    </div>
</div>

    <div id="context-menu"><div id="delete-msg">X√≥a tin nh·∫Øn üóëÔ∏è</div></div>

    <div class="main-wrapper">
        <div class="sidebar">
            <div class="sidebar-header" style="display: flex; justify-content: space-between; align-items: center; position: relative; padding: 20px; border-bottom: 1px solid #111;">
    <span style="font-size: 16px;">ATHEMIAN CHAT</span>
    <div style="display: flex; gap: 15px; align-items: center;">
        <div style="position: relative; display: inline-block; cursor: pointer;" id="noti-wrapper">
    <span id="noti-btn" style="font-size: 22px; color: #666;">üîî</span>
    <span id="badge-count" class="badge">0</span>
</div>
<div style="display: flex; gap: 15px; align-items: center;">
    <span id="call-btn" style="cursor: pointer; font-size: 18px; color: #666;">üìû</span>
    </div>
        <span id="settings-btn" style="cursor: pointer; font-size: 18px; color: #666;">‚öôÔ∏è</span>
    </div>
    
    <div id="notification-panel">
        <div class="noti-header">
            <span>Th√¥ng b√°o</span>
            <span id="clear-noti" style="cursor: pointer; color: #555; font-size: 11px;">X√≥a h·∫øt</span>
        </div>
        <div id="noti-list-content" class="noti-list">
            <div class="noti-item"><b>H·ªá th·ªëng:</b> Ch√†o m·ª´ng b·∫°n ƒë√£ ƒë·∫øn v·ªõi AthemianArtory!</div>
            <div class="noti-item" style="color: #ff9800;"><b>B·∫£o tr√¨:</b> D·ª± ki·∫øn b·∫£o tr√¨ m√°y ch·ªß v√†o 11:14 ph√∫t t·ªëi nay.</div>
        </div>
    </div>
</div>
            <div class="room-controls">
    <button id="discord-add-btn" style="width: 100%; padding: 12px; border-radius: 12px; border: 1px dashed #555; background: #111; color: #0084ff; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; transition: 0.3s;">
        <span style="font-size: 20px;">+</span> T·∫°o ho·∫∑c V√†o ph√≤ng
    </button>

    <div id="room-input-area" style="display: none; margin-top: 15px; padding: 10px; background: #0a0a0a; border-radius: 10px; border: 1px solid #222;">
        <input type="text" id="room-input" placeholder="T√™n ph√≤ng..." style="width: 100%; padding: 10px; background: #1a1a1a; border: none; color: white; border-radius: 8px; margin-bottom: 8px;">
        <input type="password" id="room-pass" placeholder="M·∫≠t kh·∫©u (n·∫øu c√≥)..." style="width: 100%; padding: 10px; background: #1a1a1a; border: none; color: white; border-radius: 8px; margin-bottom: 8px;">
        <div class="btn-group" style="display: flex; gap: 5px;">
            <button id="join-btn" style="flex: 1; padding: 8px; border-radius: 8px; border: none; background: #0084ff; color: white; font-weight: bold; cursor: pointer;">V√†o ngay</button>
            <button id="cancel-room-btn" style="padding: 8px; border-radius: 8px; border: none; background: #333; color: white; cursor: pointer;">H·ªßy</button>
        </div>
    </div>
</div>
            
            <div class="current-room-tag">üìç <span id="room-display">S·∫£nh chung</span></div>

            <div class="friend-section">
                <h4>B·∫°n b√®</h4>
                <div id="friend-list"></div>
            </div>

            <div class="add-friend-box">
                <input type="text" id="add-friend-input" placeholder="T√™n b·∫°n b√®..." style="width:100%; padding:8px; border-radius:8px; border:none; background:#1a1a1a; color:white; margin-bottom:5px;">
                <button id="add-friend-btn" style="width:100%; background:#28a745; color:white; border:none; padding:8px; border-radius:8px; font-weight:bold; cursor:pointer; font-size:12px;">+ K·∫øt b·∫°n</button>
            </div>
        </div>

        <div class="chat-container">
            <div id="chat-box"></div>
            
            <div class="bottom-toolbar">
                <input type="text" id="username" readonly>
                <div class="input-wrapper">
                    <input type="text" id="msg-input" placeholder="Vi·∫øt g√¨ ƒë√≥ chubby ƒëi n√†o..." autocomplete="off">
                </div>
                <button id="emoji-btn" class="icon-btn">üòä</button>
                <button id="img-btn" class="icon-btn">üì∑</button>
                <button id="file-btn" class="icon-btn">üìé</button>
                <input type="file" id="file-input-hidden" style="display: none;">
                <button id="send-btn">G·ª≠i</button>
            </div>

            <div id="emoji-picker">
                <span class="emoji-item">üòä</span><span class="emoji-item">üòÇ</span><span class="emoji-item">ü§£</span><span class="emoji-item">üòç</span><span class="emoji-item">ü•∞</span>
                <span class="emoji-item">üëç</span><span class="emoji-item">üî•</span><span class="emoji-item">‚ù§Ô∏è</span><span class="emoji-item">‚ú®</span><span class="emoji-item">üò≠</span>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script>

// 2. X·ª≠ l√Ω khi b·∫°n b·∫•m n√∫t g·ªçi (üìû)
document.getElementById('call-btn').onclick = () => {
    const target = prompt("Nh·∫≠p ID ng∆∞·ªùi b·∫°n mu·ªën g·ªçi:");
    if(!target) return;

    navigator.mediaDevices.getUserMedia({ audio: true, video: false }).then((stream) => {
        const call = peer.call(target + "-athemian-id", stream);
        sendSystemNotification("Cu·ªôc g·ªçi", "ƒêang ƒë·ªï chu√¥ng t·ªõi " + target, "orange");
        
        call.on('stream', (remoteStream) => {
            const audio = document.createElement('audio');
            audio.srcObject = remoteStream;
            audio.play();
        });
    }).catch(err => {
        sendSystemNotification("L·ªói", "Kh√¥ng t√¨m th·∫•y Microphone!", "red");
    });
};
// --- LOGIC H·ªÜ TH·ªêNG TH√îNG B√ÅO ---
const notiBtn = document.getElementById('noti-btn');
const notiPanel = document.getElementById('notification-panel');
const badge = document.getElementById('badge-count');
const notiList = document.getElementById('noti-list-content');
let unreadCount = 2; // Gi·∫£ s·ª≠ c√≥ 2 th√¥ng b√°o m·ªõi l√∫c ƒë·∫ßu

// Hi·ªÉn th·ªã s·ªë l∆∞·ª£ng th√¥ng b√°o ban ƒë·∫ßu
if(unreadCount > 0) {
    badge.innerText = unreadCount;
    badge.style.display = 'block';
}
function deleteFriend(event, friendName) {
    // NgƒÉn ch·∫∑n s·ª± ki·ªán click lan ra ngo√†i (kh√¥ng m·ªü chat khi b·∫•m n√∫t xo√°)
    event.stopPropagation();

    if (confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën xo√° ${friendName} kh·ªèi danh s√°ch b·∫°n b√®?`)) {
        // L·ªánh xo√° tr√™n GunDB b·∫±ng c√°ch g√°n gi√° tr·ªã false ho·∫∑c null
        gun.get('users-v1').get(myUser).get('friends').get(friendName).put(false);
        
        // Th√¥ng b√°o cho ng∆∞·ªùi d√πng qua chu√¥ng üîî
        sendSystemNotification("B·∫°n b√®", `ƒê√£ xo√° ${friendName} kh·ªèi danh s√°ch.`, "gray");
        
        // N·∫øu ƒëang chat v·ªõi ng∆∞·ªùi n√†y th√¨ chuy·ªÉn v·ªÅ S·∫£nh chung
        if (document.getElementById('room-display').innerText.includes(friendName)) {
            currentRoomId = 'chubby-lobby-v1';
            document.getElementById('room-display').innerText = "üìç S·∫£nh chung";
            listen(currentRoomId);
        }
    }
}
// Click v√†o chu√¥ng ƒë·ªÉ ƒë√≥ng/m·ªü b·∫£ng
document.getElementById('noti-wrapper').onclick = (e) => {
    e.stopPropagation();
    const isVisible = notiPanel.style.display === 'block';
    notiPanel.style.display = isVisible ? 'none' : 'block';
    
    // Khi m·ªü b·∫£ng ra th√¨ ·∫©n d·∫•u ch·∫•m ƒë·ªè (ƒë√£ xem)
    if(!isVisible) {
        unreadCount = 0;
        badge.style.display = 'none';
    }
};

// H√†m d√πng ƒë·ªÉ g·ª≠i th√¥ng b√°o m·ªõi t·ª´ h·ªá th·ªëng (B·∫°n c√≥ th·ªÉ g·ªçi h√†m n√†y ·ªü b·∫•t c·ª© ƒë√¢u)
function sendSystemNotification(title, message, color = "#ccc") {
    const div = document.createElement('div');
    div.className = 'noti-item';
    div.style.color = color;
    div.innerHTML = `<b>${title}:</b> ${message}`;
    
    // Th√™m v√†o danh s√°ch th√¥ng b√°o
    const listContent = document.getElementById('noti-list-content');
    listContent.prepend(div); 
    
    // 1. Ph√°t ti·∫øng Ting
    const sound = document.getElementById('noti-sound');
    if(sound) sound.play();

    // 2. C·∫≠p nh·∫≠t s·ªë ƒë·ªè tr√™n chu√¥ng
    unreadCount++;
    badge.innerText = unreadCount;
    badge.style.display = 'block';
}

// N√∫t x√≥a s·∫°ch th√¥ng b√°o
document.getElementById('clear-noti').onclick = () => {
    notiList.innerHTML = '<div class="noti-item" style="text-align:center; color:#555;">Kh√¥ng c√≥ th√¥ng b√°o m·ªõi</div>';
};

// Click ra ngo√†i th√¨ ƒë√≥ng b·∫£ng th√¥ng b√°o
window.addEventListener('click', () => {
    notiPanel.style.display = 'none';
});
    // --- X·ª¨ L√ù N√öT T·∫†O PH√íNG KI·ªÇU DISCORD ---
const discordBtn = document.getElementById('discord-add-btn');
const roomArea = document.getElementById('room-input-area');
const cancelRoomBtn = document.getElementById('cancel-room-btn');

// B·∫•m n√∫t + th√¨ hi·ªán √¥ nh·∫≠p
discordBtn.onclick = () => {
    roomArea.style.display = 'block';
    discordBtn.style.display = 'none';
};

// B·∫•m H·ªßy th√¨ quay l·∫°i n√∫t +
cancelRoomBtn.onclick = () => {
    roomArea.style.display = 'none';
    discordBtn.style.display = 'flex';
};

// Logic khi b·∫•m "V√†o ngay"
document.getElementById('join-btn').onclick = () => {
    const roomName = document.getElementById('room-input').value.trim();
    const roomPass = document.getElementById('room-pass').value.trim();
    
    if(!roomName) return alert("Vui l√≤ng nh·∫≠p t√™n ph√≤ng!");

    // ƒê·ªïi ph√≤ng chat
    currentRoomId = 'room-' + CryptoJS.SHA256(roomName + roomPass).toString().substring(0, 15);
    document.getElementById('room-display').innerText = "Ph√≤ng: " + roomName;
    
    // Thu g·ªçn l·∫°i giao di·ªán sau khi v√†o ph√≤ng
    roomArea.style.display = 'none';
    discordBtn.style.display = 'flex';
    
    // L√†m m·ªõi tin nh·∫Øn
    listen(currentRoomId);
};
    const gun = Gun(['https://gun-manhattan.herokuapp.com/gun']);
    let currentRoomId = 'chubby-lobby-v1';
    let myUser = "";
    let selectedMsgId = null;

    const chatBox = document.getElementById('chat-box');
    const msgInput = document.getElementById('msg-input');
    const userField = document.getElementById('username');
    const menu = document.getElementById('context-menu');

    // --- H√ÄM ƒêƒÇNG NH·∫¨P TH√ÄNH C√îNG ---
    function loginSuccess(user) {
    myUser = user;
    userField.value = user;
    localStorage.setItem('saved_user_chubby', user);

    // ·∫®n c√°c m√†n h√¨nh ch·ªù
    document.getElementById('intro-overlay').style.display = 'none';
    document.getElementById('auth-overlay').style.display = 'none';
    
    // Ch·ªâ kh·ªüi ƒë·ªông h·ªá th·ªëng Call sau khi ƒë√£ c√≥ t√™n ng∆∞·ªùi d√πng
    initCallSystem(user); 

    loadFriends();
    listen(currentRoomId);
}
    

    // --- T·ª∞ ƒê·ªòNG ƒêƒÇNG NH·∫¨P KHI M·ªû TRANG ---
    window.onload = () => {
        const savedName = localStorage.getItem('saved_user_chubby');
        if(savedName) {
            loginSuccess(savedName);
        }
    };

    // --- X·ª¨ L√ù N√öT B√ÅNH RƒÇNG (ƒêƒÇNG XU·∫§T) ---
    document.getElementById('settings-btn').onclick = () => {
        if(confirm("B·∫°n c√≥ mu·ªën ƒëƒÉng xu·∫•t kh√¥ng?")) {
            localStorage.removeItem('saved_user_chubby'); // X√≥a ghi nh·ªõ
            location.reload(); // T·∫£i l·∫°i trang ƒë·ªÉ v·ªÅ m√†n h√¨nh ƒëƒÉng nh·∫≠p
        }
    };

    // N√∫t ƒë√≥ng b·∫£ng gi·ªõi thi·ªáu
    document.getElementById('close-intro-btn').onclick = () => {
        const intro = document.getElementById('intro-overlay');
        intro.style.transition = "opacity 0.5s ease";
        intro.style.opacity = "0";
        setTimeout(() => { intro.style.display = 'none'; }, 500);
    };

    // N√∫t ƒëƒÉng nh·∫≠p/b·∫Øt ƒë·∫ßu
    document.getElementById('auth-btn').onclick = () => {
        const user = document.getElementById('auth-user').value.trim();
        const pass = document.getElementById('auth-pass').value.trim();
        sendSystemNotification("C·∫£nh b√°o", "Vui l√≤ng nh·∫≠p ID v√† M·∫≠t kh·∫©u!", "orange");

        const hashedPass = CryptoJS.SHA256(pass).toString();
        const userRef = gun.get('users-v1').get(user);

        userRef.once((data) => {
            if(data) {
                if(data.pw === hashedPass) {
                    loginSuccess(user);
                } else {
                    // Thay alert c≈© b·∫±ng h√†m th√¥ng b√°o chuy√™n nghi·ªáp
sendSystemNotification("B·∫£o m·∫≠t", "M·∫≠t kh·∫©u kh√¥ng ch√≠nh x√°c!", "red");
                }
            } else {
                userRef.put({ pw: hashedPass });
                alert("ƒê√£ t·∫°o t√†i kho·∫£n m·ªõi!");
                loginSuccess(user);
            }
        });
    };

    // --- H·ªÜ TH·ªêNG TIN NH·∫ÆN & B·∫†N B√à (GI·ªÆ NGUY√äN) ---
    // X·ª≠ l√Ω khi nh·∫•n n√∫t K·∫øt b·∫°n
document.getElementById('add-friend-btn').onclick = () => {
    const friendName = document.getElementById('add-friend-input').value.trim();
    
    if(!friendName) {
        sendSystemNotification("H·ªá th·ªëng", "B·∫°n ch∆∞a nh·∫≠p t√™n ng∆∞·ªùi mu·ªën k·∫øt b·∫°n!", "orange");
        return;
    }

    // L·ªánh l∆∞u v√†o c∆° s·ªü d·ªØ li·ªáu GunDB
    gun.get('users-v1').get(myUser).get('friends').get(friendName).put(true);
    
    // Hi·ªán th√¥ng b√°o l√™n Chu√¥ng üîî
    sendSystemNotification("B·∫°n b√®", "ƒê√£ g·ª≠i y√™u c·∫ßu k·∫øt b·∫°n t·ªõi " + friendName, "#28a745");
    
    // X√≥a s·∫°ch √¥ nh·∫≠p
    document.getElementById('add-friend-input').value = "";
};
    function loadFriends() {
    gun.get('users-v1').get(myUser).get('friends').map().on((val, name) => {
        // N·∫øu val l√† null ho·∫∑c false, t·ª©c l√† ƒë√£ xo√° b·∫°n, ta xo√° ph·∫ßn t·ª≠ ƒë√≥ kh·ªèi giao di·ªán
        if (!val) {
            const oldDiv = document.getElementById('f-' + name);
            if (oldDiv) oldDiv.remove();
            return;
        }

        let flist = document.getElementById('friend-list');
        if (!document.getElementById('f-' + name)) {
            let div = document.createElement('div');
            div.id = 'f-' + name; 
            div.className = 'friend-item';
            div.style.display = 'flex';
            div.style.justifyContent = 'space-between';
            div.style.alignItems = 'center';

            // Ph·∫ßn hi·ªÉn th·ªã t√™n
            div.innerHTML = `
                <span onclick="startPrivateChat('${name}')" style="flex: 1;">üë§ ${name}</span>
                <span class="delete-friend-btn" onclick="deleteFriend(event, '${name}')" 
                      style="color: #ff4d4d; padding: 5px 10px; cursor: pointer; font-weight: bold; font-size: 14px;">√ó</span>
            `;
            flist.appendChild(div);
        }
    });
}

    function startPrivateChat(targetName) {
        const id = [myUser, targetName].sort().join('-PRIVATE-');
        currentRoomId = 'dm-' + CryptoJS.SHA256(id).toString().substring(0, 15);
        document.getElementById('room-display').innerText = "Chat v·ªõi: " + targetName;
        document.querySelectorAll('.friend-item').forEach(i => i.classList.remove('active'));
        if(document.getElementById('f-'+targetName)) document.getElementById('f-'+targetName).classList.add('active');
        listen(currentRoomId);
    }

    function post(content, type = 'text') {
        gun.get(currentRoomId).set({ name: myUser, text: content, type: type, time: Date.now() });
    }

    function listen(id) {
        chatBox.innerHTML = '';
        gun.get(id).map().on((data, mid) => {
            const old = document.getElementById(mid);
            if(!data) { if(old) old.remove(); return; }
            let wrap = old || document.createElement('div');
            wrap.id = mid;
            if(!old) chatBox.appendChild(wrap);
            const isMe = data.name === myUser;
            wrap.className = `msg-wrapper ${isMe ? 'my-msg' : 'other-msg'}`;
            let html = `<div class="msg-text">${data.text}</div>`;
            if(data.type === 'image') html = `<div class="msg-text" style="background:none;"><img src="${data.text}" style="max-width:200px;border-radius:10px;"></div>`;
            else if(data.type === 'file') html = `<div class="msg-text">üìé <a href="${data.text}" download style="color:#0084ff">File</a></div>`;
            wrap.innerHTML = `<div class="msg-name">${data.name}</div>${html}`;
            wrap.oncontextmenu = (e) => { e.preventDefault(); selectedMsgId = mid; menu.style.display='block'; menu.style.left=e.pageX+'px'; menu.style.top=e.pageY+'px'; };
            chatBox.scrollTop = chatBox.scrollHeight;
        });
    }

    document.getElementById('send-btn').onclick = () => { if(msgInput.value){ post(msgInput.value); msgInput.value=""; } };
    msgInput.onkeydown = (e) => { if(e.key==='Enter') document.getElementById('send-btn').click(); };

    const fIn = document.getElementById('file-input-hidden');
    document.getElementById('img-btn').onclick = () => { fIn.accept="image/*"; fIn.onchange=(e)=>{ const r=new FileReader(); r.onload=ev=>post(ev.target.result,'image'); r.readAsDataURL(e.target.files[0]); }; fIn.click(); };
    document.getElementById('file-btn').onclick = () => { fIn.accept="*/*"; fIn.onchange=(e)=>{ const r=new FileReader(); r.onload=ev=>post(ev.target.result,'file'); r.readAsDataURL(e.target.files[0]); }; fIn.click(); };
    document.getElementById('delete-msg').onclick = () => { if(selectedMsgId) { gun.get(currentRoomId).get(selectedMsgId).put(null); menu.style.display='none'; } };

    const p = document.getElementById('emoji-picker');
    document.getElementById('emoji-btn').onclick = (e) => { e.stopPropagation(); p.style.display = p.style.display==='grid'?'none':'grid'; };
    document.querySelectorAll('.emoji-item').forEach(el => { el.onclick = () => { msgInput.value += el.innerText; p.style.display='none'; }; });
    window.onclick = () => { menu.style.display='none'; p.style.display='none'; };
    // --- H·ªÜ TH·ªêNG CALL (ƒê√É S·ª¨A L·ªñI T√ä LI·ªÜT) ---
let peer = null;

function initCallSystem(userId) {
    // N·∫øu ƒë√£ t·∫°o r·ªìi th√¨ kh√¥ng t·∫°o n·ªØa
    if (peer) return;

    // T·∫°o ID cu·ªôc g·ªçi d·ª±a tr√™n t√™n ng∆∞·ªùi d√πng
    peer = new Peer(userId + "-athemian-id");

    peer.on('open', (id) => {
        console.log('H·ªá th·ªëng g·ªçi ƒë√£ s·∫µn s√†ng. ID c·ªßa b·∫°n:', id);
        sendSystemNotification("H·ªá th·ªëng", "H·ªá th·ªëng g·ªçi ƒëi·ªán ƒë√£ s·∫µn s√†ng!", "#00ff00");
    });

    // L·∫Øng nghe cu·ªôc g·ªçi ƒë·∫øn
    peer.on('call', (call) => {
        if(confirm("C√≥ cu·ªôc g·ªçi ƒë·∫øn! Ch·∫•p nh·∫≠n?")) {
            navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {
                call.answer(stream);
                call.on('stream', (remoteStream) => {
                    const audio = new Audio();
                    audio.srcObject = remoteStream;
                    audio.play();
                });
            }).catch(err => {
                sendSystemNotification("L·ªói", "Kh√¥ng th·ªÉ truy c·∫≠p Microphone!", "red");
            });
        }
    });
}

// T√¨m n√∫t g·ªçi ƒëi·ªán (üìû) v√† x·ª≠ l√Ω khi b·∫•m
const callBtn = document.getElementById('call-btn');
if(callBtn) {
    callBtn.onclick = () => {
        const target = prompt("Nh·∫≠p ID ng∆∞·ªùi b·∫°n mu·ªën g·ªçi:");
        if(!target || !peer) return;

        navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {
            const call = peer.call(target + "-athemian-id", stream);
            sendSystemNotification("Cu·ªôc g·ªçi", "ƒêang g·ªçi t·ªõi " + target + "...", "orange");
            
            call.on('stream', (remoteStream) => {
                const audio = new Audio();
                audio.srcObject = remoteStream;
                audio.play();
            });
        });
    };
}
</script>
</body>

</html>